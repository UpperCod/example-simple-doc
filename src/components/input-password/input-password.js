import { h, customElement, useProp, useHost, useEffect } from "atomico";
import style from "./input-password.css";

function InputPassword({ primaryColor, secondColor, placeholder }) {
  let [show, setShow] = useProp("show");
  let [, setValue] = useProp("value");
  let ref = useHost();
  useEffect(() => {
    ref.size = ref.current.clientWidth * 2 + "px";
  }, [show]);
  return (
    <host shadowDom>
      <style>{style}</style>
      <label style={`background:${primaryColor}`}>
        <svg width="10" height="13" viewBox="0 0 10 13">
          <path
            style={`fill:${show ? primaryColor : secondColor}`}
            d="M2,13a2,2,0,0,1-2-2V6A1,1,0,0,1,1,5V4A4,4,0,0,1,9,4V5H9a1,1,0,0,1,1,1v5a2,2,0,0,1-2,2ZM7,5V4A2,2,0,0,0,3,4V5Z"
          />
        </svg>
        <input
          type={show ? "text" : "password"}
          placeholder={placeholder}
          style={`color:${show ? primaryColor : secondColor}`}
          oninput={({ target: { value } }) => setValue(value)}
        />
        <button onclick={() => setShow((show) => !show)}>
          <div
            style={`background:${secondColor};width:${
              show ? ref.size || "100%" : "100%"
            };height:${show ? ref.size || "100%" : "100%"}`}
          ></div>
          <svg width="90%" viewBox="0 0 71.118 48">
            <g fill="transparent">
              <path
                d="M 35.5592041015625 44 C 31.73834228515625 44 27.71065330505371 42.89445114135742 23.58805465698242 40.71407318115234 C 20.13562965393066 38.88814926147461 16.62136650085449 36.31779861450195 13.14287948608398 33.07442474365234 C 9.436678886413574 29.61873626708984 6.590166568756104 26.162109375 4.940739631652832 24.00221061706543 C 6.614989280700684 21.81179237365723 9.516806602478027 18.28898620605469 13.26477909088135 14.81219959259033 C 16.72964096069336 11.59803771972656 20.22876739501953 9.052187919616699 23.66495323181152 7.245375156402588 C 27.76039123535156 5.091899871826172 31.76220321655273 4 35.5592041015625 4 C 39.38006591796875 4 43.40775299072266 5.105549812316895 47.53035354614258 7.285924911499023 C 50.98278045654297 9.111849784851074 54.49703979492188 11.68220043182373 57.97552871704102 14.92557525634766 C 61.68172836303711 18.38126373291016 64.52824401855469 21.837890625 66.17766571044922 23.99778938293457 C 64.50341796875 26.18820762634277 61.60160064697266 29.71101379394531 57.85363006591797 33.18780136108398 C 54.38876724243164 36.40196228027344 50.88964080810547 38.94781112670898 47.45345306396484 40.75462341308594 C 43.35801696777344 42.90810012817383 39.35620498657227 44 35.5592041015625 44 Z"
                stroke="none"
              />
              <path
                d="M 35.5592041015625 8 C 25.62734985351563 8 15.6253662109375 17.32173156738281 10.03081893920898 24 C 15.6253662109375 30.67826843261719 25.62734985351563 40 35.5592041015625 40 C 45.49105834960938 40 55.4930419921875 30.67826843261719 61.08758544921875 24 C 55.4930419921875 17.32173156738281 45.49105834960938 8 35.5592041015625 8 M 35.5592041015625 0 C 55.19800567626953 0 71.11840057373047 24 71.11840057373047 24 C 71.11840057373047 24 55.19800567626953 48 35.5592041015625 48 C 15.92040252685547 48 7.62939453125e-06 24 7.62939453125e-06 24 C 7.62939453125e-06 24 15.92040252685547 0 35.5592041015625 0 Z"
                stroke="none"
                fill={primaryColor}
              />
            </g>
            <g transform="translate(25.059 13)" fill={primaryColor}>
              <path
                d="M 11 21.5 C 5.210279941558838 21.5 0.5 16.78972053527832 0.5 11 C 0.5 5.210279941558838 5.210279941558838 0.5 11 0.5 C 16.78972053527832 0.5 21.5 5.210279941558838 21.5 11 C 21.5 16.78972053527832 16.78972053527832 21.5 11 21.5 Z"
                stroke="none"
              />
              <path
                d="M 11 1 C 5.485979080200195 1 1 5.485979080200195 1 11 C 1 16.51401901245117 5.485979080200195 21 11 21 C 16.51401901245117 21 21 16.51401901245117 21 11 C 21 5.485979080200195 16.51401901245117 1 11 1 M 11 0 C 17.07513046264648 0 22 4.924869537353516 22 11 C 22 17.07513046264648 17.07513046264648 22 11 22 C 4.924869537353516 22 0 17.07513046264648 0 11 C 0 4.924869537353516 4.924869537353516 0 11 0 Z"
                stroke="none"
                fill={primaryColor}
              />
            </g>
          </svg>
        </button>
      </label>
    </host>
  );
}

InputPassword.props = {
  value: {
    type: String,
    event: {
      type: "change",
      bubbles: true,
    },
  },
  placeholder: String,
  primaryColor: { type: String, value: "black" },
  secondColor: { type: String, value: "white" },
  show: { type: Boolean, reflect: true },
};

customElement("input-password", InputPassword);
